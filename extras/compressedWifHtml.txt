<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><title>Wifi Settings</title><link rel="stylesheet" href="/style.css" /><style>.middleIt{display:flex;justify-content:center;text-align:center}input{margin-top:10px}</style> <script src="/jquery.js"></script> <script src="/jquery.js?menu"></script> </head><body style="font-size: 16px"> <br /><br /><div class="middleIt"><div class="middleIt" id="mainForm" style=" width: 380px; box-shadow: -2px -2px 5px #fff, 2px 2px 5px #babecc; border-radius: 20px; margin-bottom: 10px; " ><form method="GET" action="#" id="login-form" class="login-form" autocomplete="off" role="main" ><h2>Wifi & Hotspot Settings</h2><div> <label for="wifiname">Wifi Name* </label> <input type="text" class="text" name="wifiname" id="wifiname" placeholder="Wifi Name" tabindex="1" required /></div> <br /><div> <label for="wifipass">Wifi Password*</label> <input type="password" class="text" name="wifipass" itemid="wifipass" id="wifipass" placeholder="Wifi Password" tabindex="1" required /></div> <br /><div> <label for="hotname">Hotspot Name*</label> <input type="text" class="text" name="hotname" id="hotname" placeholder="Hotspot Name" tabindex="1" required /></div> <br /><div> <label for="hotpass">Hotspot Password*</label> <input type="password" class="text" name="hotpass" id="hotpass" placeholder="Hotspot Password" tabindex="1" required /></div> <br /><div> <label for="hotname">User Name*</label> <input type="text" class="text" name="username" id="username" placeholder="User Name" tabindex="1" required /></div> <br /><div> <label for="lockpass">Lock Password*</label> <input type="password" class="text" name="lockpass" id="lockpass" placeholder="Lock Password" tabindex="1" required /></div> <br /><h2>MQTT Settings</h2><div> <label for="server">Server IP* </label> <input type="text" class="text" name="server" id="server" placeholder="Server IP" tabindex="1" required /></div><br /><div> <label for="mqttuser">MQTT User ID* </label> <input type="text" class="text" name="mqttuser" id="mqttuser" placeholder="MQTT User ID" tabindex="1" required /></div><br /><div> <label for="mqttpass">MQTT Password*</label> <input type="password" class="text" name="mqttpass" id="mqttpass" placeholder="MQTT Password" tabindex="1" required /></div><br /><div> <label for="token">Token ID*</label> <input type="password" class="text" name="token" id="token" placeholder="Token ID" tabindex="1" required /></div><br /><div> <label for="device">Device ID (Read Only)</label> <input type="password" class="text" name="device" id="device" placeholder="espHOME" tabindex="1" /></div> <br /><div> <span id="showPassword" style=" cursor: pointer; text-decoration: underline; font-weight: 600; " >Show Passwords!! </span></div><br /><h2>Service Settings</h2><div style="flex-direction: row"><h4 style="word-spacing: 30px">WIFI HOTSPOT MQTT</h4> <button style="margin-left: 20px; margin-right: 20px" class="unit" type="button" id="wifi" ison="0" > ... </button> <button style="margin-left: 20px; margin-right: 20px" class="unit" type="button" id="hotspot" ison="0" > ... </button> <button style="margin-left: 20px; margin-right: 20px" class="unit" type="button" id="mqtt" ison="0" > ... </button></div> <br /><p id="showTheTime" style="color: #d1ce0d; font-size: 18px; font-weight: 600" ></p><p id="warnings" style="color: #d47304; font-size: 18px; font-weight: 600" ></p> <button type="submit" name="submit" value="Save Settings" id="toSubmit" class="red" > Save Settings </button></form></div> <br /></div><div><button id="menuBtn">&#9776;</button></div> %MENU% <br /><br /> <script>var ww = %WIFIOBJ% ;var mm = %MQTTOBJ% ;var myWifiObj,myMqttObj;try{myWifiObj=JSON.parse(ww),myMqttObj=JSON.parse(mm)}catch(t){};function ValidateIPaddress(t){return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(t)}JSON.stringify(myWifiObj),JSON.stringify(myMqttObj),$(function(){let o=$("#warnings").hide(),r=$("#wifipass"),n=$("#wifiname"),c=$("#hotname"),l=$("#hotpass"),f=$("#username"),p=$("#lockpass");$("#showTime");let y=$("#server"),m=$("#mqttuser"),b=$("#mqttpass"),O=$("#device"),v=$("#token"),u=$("#wifi"),d=$("#mqtt"),g=$("#hotspot");n.val(myWifiObj.wifi),r.val(myWifiObj.wifipw),c.val(myWifiObj.ap),l.val(myWifiObj.appw),f.val(myWifiObj.user),p.val(myWifiObj.lock),y.val(myMqttObj.server),m.val(myMqttObj.user),b.val(myMqttObj.pass),O.val(myWifiObj.device),v.val(myMqttObj.token),0==myWifiObj.mode?(g.attr("ison",1).text("ON").css({"background-color":"#ec4a4a33"}),u.attr("ison",0).text("OFF")):1==myWifiObj.mode&&(u.attr("ison",1).text("ON").css({backgroundColor:"rgba(143, 235, 135, 0.4)"}),g.attr("ison",0).text("OFF")),0==myMqttObj.ison?d.attr("ison",0).text("OFF"):d.attr("ison",1).text("ON").css({"background-color":"rgba(181, 219, 251, 0.4)"}),d.click(function(){1==d.attr("ison")?d.attr("ison",0).text("OFF").css({"background-color":"#ebecf0"}):d.attr("ison",1).text("ON").css({"background-color":"rgba(181, 219, 251, 0.4)"})}),u.click(function(){1==u.attr("ison")?(g.attr("ison",1).text("ON").css({"background-color":"#ec4a4a33"}),u.attr("ison",0).text("OFF").css({"background-color":"#ebecf0"})):u.attr("ison",1).text("ON").css({backgroundColor:"rgba(143, 235, 135, 0.4)"})}),g.click(function(){1==g.attr("ison")?(u.attr("ison",1).text("ON").css({backgroundColor:"rgba(143, 235, 135, 0.4)"}),g.attr("ison",0).text("OFF").css({"background-color":"#ebecf0"})):g.attr("ison",1).text("ON").css({"background-color":"#ec4a4a33"})}),$("#toSubmit").click(function(){var e=y.val();if(!ValidateIPaddress(e))return o.text("Invalid IP Address").show(),void console.log(ValidateIPaddress(e));if(!0===confirm("You are one step away of changing system settings. This process will reset your device!! Press OK to confirm...")){console.log("");let o=[];console.log("cont 1"),console.log("cont 11"),console.log("cont 111");let s=r.val();console.log("cont 2"),r.val()!=myWifiObj.wifipw&&o.push({for:"wifipass",pay:s}),console.log("cont 3"),s=n.val(),n.val()!=myWifiObj.wifi&&o.push({for:"wifiname",pay:s}),s=c.val(),c.val()!=myWifiObj.ap&&o.push({for:"hotname",pay:s}),s=l.val(),l.val()!=myWifiObj.appw&&o.push({for:"hotpass",pay:s}),s=f.val(),f.val()!=myWifiObj.user&&o.push({for:"wifiuser",pay:s}),s=p.val(),p.val()!=myWifiObj.lock&&o.push({for:"lockpass",pay:s}),s=y.val(),y.val()!=myMqttObj.server&&o.push({for:"server",pay:s}),s=m.val(),m.val()!=myMqttObj.user&&o.push({for:"mqttuser",pay:s}),s=b.val(),b.val()!=myMqttObj.pass&&o.push({for:"mqttpass",pay:s}),s=O.val(),O.val()!=myWifiObj.device&&o.push({for:"device",pay:s}),s=v.val(),v.val()!=myMqttObj.token&&o.push({for:"token",pay:s});let a=0;s=u.attr("ison"),1==s&&(a=1),t=g.attr("ison"),1==t&&(a=0),1==s&&1==t&&(a=2),a!=myWifiObj.mode&&o.push({for:"wifimode",pay:a}),s=d.attr("ison"),s!=myMqttObj.ison&&o.push({for:"mqttmode",pay:s}),console.log(o);var i={data:o},e=JSON.stringify(i);console.log(i);i=new XMLHttpRequest;i.open("POST","/changesettings",!0),i.setRequestHeader("config",e),i.send()}});let s=0,a=$("#showPassword");a.hover(function(){$(this).css({color:"#0077ff","font-weight":"800"})},function(){$(this).css({color:"#babecc","font-weight":"600"})}),a.click(function(){return 0==s?(s=1,r.attr("type","text"),p.attr("type","text"),l.attr("type","text"),b.attr("type","text"),O.attr("type","text"),void v.attr("type","text")):(s=0,r.attr("type","password"),p.attr("type","password"),l.attr("type","password"),b.attr("type","password"),O.attr("type","password"),void v.attr("type","password"))})});</script> </body></html>